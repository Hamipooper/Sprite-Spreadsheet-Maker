<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sprite Sheet Animator</title>
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            margin: 0;
            padding: 20px;
            background: #1a1a1a;
            color: #e8e8e8;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            margin: 0 0 30px 0;
            font-size: 28px;
        }

        .card {
            background: #2d2d2d;
            border-radius: 8px;
            padding: 24px;
            margin-bottom: 20px;
            border: 1px solid #444;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            font-weight: 500;
            margin-bottom: 8px;
            font-size: 14px;
        }

        input[type="text"],
        input[type="number"],
        input[type="file"],
        textarea,
        select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #444;
            border-radius: 6px;
            font-size: 14px;
            font-family: inherit;
            background: #1a1a1a;
            color: #e8e8e8;
            transition: border-color 0.2s;
        }

        input[type="file"]:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: #4a9eff;
        }

        textarea {
            min-height: 80px;
            resize: vertical;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            background: #4a9eff;
            color: #1a1a1a;
        }

        .btn:hover:not(:disabled) {
            background: #3a8ee8;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-secondary {
            background: transparent;
            color: #4a9eff;
            border: 1px solid #4a9eff;
        }

        .btn-secondary:hover:not(:disabled) {
            background: rgba(74, 158, 255, 0.1);
        }

        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .preview-section {
            margin-top: 20px;
            border: 1px solid #444;
            border-radius: 8px;
            padding: 20px;
            background: #1a1a1a;
        }

        .preview-canvas {
            max-width: 100%;
            height: auto;
            border: 1px solid #444;
            border-radius: 4px;
            background: #0d0d0d;
        }

        .frame-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .frame-item {
            border: 2px solid #444;
            border-radius: 4px;
            padding: 5px;
            cursor: pointer;
            background: #0d0d0d;
            text-align: center;
            font-size: 12px;
            transition: all 0.2s;
        }

        .frame-item:hover {
            border-color: #4a9eff;
        }

        .frame-item.active {
            border-color: #4a9eff;
            background: rgba(74, 158, 255, 0.1);
        }

        .frame-item canvas {
            width: 100%;
            height: auto;
            display: block;
            border-radius: 2px;
            margin-bottom: 5px;
        }

        .status {
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 15px;
            font-size: 14px;
        }

        .status.success {
            background: rgba(39, 174, 96, 0.2);
            color: #4ade80;
            border: 1px solid rgba(39, 174, 96, 0.5);
        }

        .status.error {
            background: rgba(231, 76, 60, 0.2);
            color: #ff6b6b;
            border: 1px solid rgba(231, 76, 60, 0.5);
        }

        .info-box {
            background: rgba(74, 158, 255, 0.1);
            border-left: 4px solid #4a9eff;
            padding: 12px;
            border-radius: 4px;
            margin-bottom: 15px;
            font-size: 13px;
            color: #aaa;
        }

        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
            .btn-group {
                flex-direction: column;
            }
            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé® Sprite Sheet Animator</h1>

        <div class="card">
            <h2>Step 1: Setup</h2>
            <div class="info-box">
                ‚ÑπÔ∏è Upload your base image, set frame grid, and create animation frames locally. No API keys needed!
            </div>

            <div class="grid">
                <div>
                    <div class="form-group">
                        <label for="imageUpload">Upload Base Image *</label>
                        <input type="file" id="imageUpload" accept="image/*" required>
                        <small style="color: #aaa; margin-top: 5px; display: block;">PNG or JPG (will be used as base for all frames)</small>
                    </div>

                    <div class="form-group">
                        <label for="frameCount">Number of Frames *</label>
                        <input type="number" id="frameCount" min="1" max="20" value="4" required>
                    </div>
                </div>

                <div>
                    <div class="form-group">
                        <label for="cols">Columns in Sprite Sheet</label>
                        <input type="number" id="cols" min="1" max="8" value="4">
                        <small style="color: #aaa; margin-top: 5px; display: block;">How many frames per row</small>
                    </div>

                    <div class="form-group">
                        <label for="animationType">Animation Type</label>
                        <select id="animationType">
                            <option value="fade">Fade In/Out</option>
                            <option value="shift">Horizontal Shift</option>
                            <option value="scale">Scale</option>
                            <option value="rotate">Rotate</option>
                            <option value="color">Color Shift</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="btn-group">
                <button class="btn" onclick="initializeFrames()">Create Frames</button>
            </div>
        </div>

        <div id="editorSection" class="card hidden">
            <h2>Step 2: Animation Preview</h2>
            <div id="statusMessage"></div>

            <div class="preview-section">
                <canvas id="previewCanvas" class="preview-canvas"></canvas>
                <div style="text-align: center; margin-top: 10px;">
                    <button class="btn" onclick="playAnimation()">‚ñ∂ Play</button>
                    <button class="btn btn-secondary" onclick="stopAnimation()">‚èπ Stop</button>
                </div>
            </div>

            <h3 style="margin-top: 20px;">Frame List</h3>
            <div class="frame-list" id="frameList"></div>

            <div class="btn-group" style="margin-top: 20px;">
                <button class="btn" onclick="exportSpriteSheet()">üì• Export Sprite Sheet</button>
                <button class="btn btn-secondary" onclick="reset()">Reset</button>
            </div>
        </div>
    </div>

    <script>
        const state = {
            baseImage: null,
            frames: [],
            frameCount: 4,
            cols: 4,
            animationType: 'fade',
            isPlaying: false,
            currentFrame: 0,
            animationInterval: null
        };

        function initializeFrames() {
            const imageUpload = document.getElementById('imageUpload');
            const frameCount = parseInt(document.getElementById('frameCount').value);
            const cols = parseInt(document.getElementById('cols').value);
            const animationType = document.getElementById('animationType').value;

            if (!imageUpload.files[0]) {
                showStatus('Please upload an image', 'error');
                return;
            }

            const reader = new FileReader();
            reader.onload = (e) => {
                const img = new Image();
                img.onload = () => {
                    state.baseImage = img;
                    state.frameCount = frameCount;
                    state.cols = cols;
                    state.animationType = animationType;
                    state.frames = [];

                    // Generate frames
                    for (let i = 0; i < frameCount; i++) {
                        const canvas = document.createElement('canvas');
                        canvas.width = img.width;
                        canvas.height = img.height;
                        const ctx = canvas.getContext('2d');

                        // Apply animation effect
                        applyAnimationEffect(ctx, img, i, frameCount, animationType);

                        state.frames.push(canvas);
                    }

                    renderFrameList();
                    document.getElementById('editorSection').classList.remove('hidden');
                    showStatus(`Created ${frameCount} frames!`, 'success');
                    renderPreview(0);
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(imageUpload.files[0]);
        }

        function applyAnimationEffect(ctx, img, frameIndex, totalFrames, type) {
            const progress = frameIndex / totalFrames;

            ctx.save();

            switch (type) {
                case 'fade':
                    ctx.globalAlpha = Math.sin(progress * Math.PI);
                    ctx.drawImage(img, 0, 0);
                    break;

                case 'shift':
                    const shiftX = progress * img.width * 0.2;
                    ctx.drawImage(img, shiftX, 0);
                    break;

                case 'scale':
                    const scale = 0.8 + progress * 0.4;
                    ctx.translate(img.width / 2, img.height / 2);
                    ctx.scale(scale, scale);
                    ctx.drawImage(img, -img.width / 2, -img.height / 2);
                    break;

                case 'rotate':
                    const angle = progress * Math.PI * 2;
                    ctx.translate(img.width / 2, img.height / 2);
                    ctx.rotate(angle);
                    ctx.drawImage(img, -img.width / 2, -img.height / 2);
                    break;

                case 'color':
                    ctx.drawImage(img, 0, 0);
                    const hue = Math.floor(progress * 360);
                    ctx.fillStyle = `hsla(${hue}, 100%, 50%, ${progress * 0.3})`;
                    ctx.fillRect(0, 0, img.width, img.height);
                    break;

                default:
                    ctx.drawImage(img, 0, 0);
            }

            ctx.restore();
        }

        function renderFrameList() {
            const frameList = document.getElementById('frameList');
            frameList.innerHTML = '';

            state.frames.forEach((frame, index) => {
                const div = document.createElement('div');
                div.className = 'frame-item' + (index === state.currentFrame ? ' active' : '');
                div.onclick = () => {
                    state.currentFrame = index;
                    renderFrameList();
                    renderPreview(index);
                };

                const canvas = document.createElement('canvas');
                canvas.width = 64;
                canvas.height = 64;
                const ctx = canvas.getContext('2d');

                // Scale down frame for thumbnail
                const scale = Math.min(64 / frame.width, 64 / frame.height);
                ctx.drawImage(frame, 0, 0, frame.width * scale, frame.height * scale);

                div.appendChild(canvas);
                div.appendChild(document.createTextNode(`Frame ${index + 1}`));
                frameList.appendChild(div);
            });
        }

        function renderPreview(frameIndex) {
            const canvas = document.getElementById('previewCanvas');
            if (!state.frames[frameIndex]) return;

            const sourceFrame = state.frames[frameIndex];
            canvas.width = sourceFrame.width;
            canvas.height = sourceFrame.height;

            const ctx = canvas.getContext('2d');
            ctx.drawImage(sourceFrame, 0, 0);
        }

        function playAnimation() {
            if (state.isPlaying) return;
            state.isPlaying = true;
            state.currentFrame = 0;

            state.animationInterval = setInterval(() => {
                renderPreview(state.currentFrame);
                state.currentFrame = (state.currentFrame + 1) % state.frames.length;
            }, 200);
        }

        function stopAnimation() {
            state.isPlaying = false;
            clearInterval(state.animationInterval);
            renderPreview(state.currentFrame);
        }

        function exportSpriteSheet() {
            if (state.frames.length === 0) {
                showStatus('No frames to export', 'error');
                return;
            }

            const rows = Math.ceil(state.frameCount / state.cols);
            const frameWidth = state.frames[0].width;
            const frameHeight = state.frames[0].height;

            const sheetCanvas = document.createElement('canvas');
            sheetCanvas.width = frameWidth * state.cols;
            sheetCanvas.height = frameHeight * rows;

            const ctx = sheetCanvas.getContext('2d');
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, sheetCanvas.width, sheetCanvas.height);

            state.frames.forEach((frame, index) => {
                const col = index % state.cols;
                const row = Math.floor(index / state.cols);
                ctx.drawImage(frame, col * frameWidth, row * frameHeight);
            });

            // Download
            sheetCanvas.toBlob((blob) => {
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'sprite_sheet.png';
                link.click();
                URL.revokeObjectURL(url);
                showStatus('Sprite sheet exported!', 'success');
            });
        }

        function reset() {
            state.baseImage = null;
            state.frames = [];
            state.isPlaying = false;
            clearInterval(state.animationInterval);
            document.getElementById('imageUpload').value = '';
            document.getElementById('editorSection').classList.add('hidden');
        }

        function showStatus(message, type) {
            const statusEl = document.getElementById('statusMessage');
            statusEl.className = 'status ' + type;
            statusEl.textContent = message;
        }
    </script>
</body>
</html>
